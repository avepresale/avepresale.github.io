import{D as M}from"./Dialog-376bb04a.js";import{u as P,f as $,d as R,e as H,g as k,D as U,r as C,o as D,c as K,a as y,l as g,j as L,s as o,n as F,E as O,b as m,t as w,k as V,A as G,G as p,H as j}from"./index-a844132a.js";import{u as J}from"./create-95644a05.js";import{B as l}from"./bignumber-3e8dfdf6.js";/* empty css                                                       */const X={class:"create"},q={class:"van-dialog__header"},z={class:"van-dialog__content"},Q={class:"van-dialog__message van-dialog__message--has-title"},Y={style:{paddingTop:"20px"}},Z={class:"create-success-title"},ee={class:"create-success-text"},ae={class:"create-success-text"},ie={__name:"Index",setup(te){const{t:s}=P(),B=$(),c=R(),x=H(),e=J(),S=k(!1),_=k(!1),v=k(!1),A=k(!1),h=k("");async function I(){console.log("createTokenClick");const t=/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/;if(c.chainId==-1){c.netErrorDialogShow=!0;return}if(e.deployerId===0||e.deployerId===1||e.deployerId===2){if(!e.name){o(s("pleaseEnterName"));return}if(!e.symbol){o(s("pleaseEnterSymbol"));return}if(!e.totalSupply){o(s("pleaseEnterTotal"));return}}if(e.deployerId===1||e.deployerId==2){if(!e.token){o(s("pleaseSelectCurrency"));return}if(!e.chainSwap){o(s("pleaseSelectSwap"));return}if(e.deployerId===1){if(l(e.buyFundFee).plus(e.buyBurnFee).plus(e.buyLPFee).plus(e.sellFundFee).plus(e.sellBurnFee).plus(e.sellLPFee).lte(0)){o(s("taxMustGt0"));return}}else if(e.deployerId===2){if(l(e.buyFundFee).plus(e.buyLPFee).plus(e.sellFundFee).plus(e.sellLPFee).lte(0)){o(s("taxlimit2"));return}}else if(e.deployerId===3){if(!e.rewardToken){o(s("dividendTokenError"));return}if(!t.test(e.rewardToken)){o(s("pleaseEnterTrueAddress"));return}if(l(e.buyFundFee).plus(e.buyLPFee).plus(e.buyRewardFee).plus(e.sellFundFee).plus(e.sellLPFee).plus(e.sellRewardFee).lte(0)){o(s("taxMustGt0"));return}}if((Number(e.buyFundFee)>0||Number(e.sellFundFee)>0)&&!e.fundAddress){o(s("pleaseEnterMarketingAddress"));return}if(e.fundAddress&&!t.test(e.fundAddress)){o(s("pleaseEnterTrueAddress"));return}if(e.enableKillBlock&&(!e.killBlock||Number(e.killBlock)<=0)){o(s("pleaseEnterKillBlockNumber"));return}if(e.enableWalletLimit&&(!e.maxWalletAmount||Number(e.maxWalletAmount)<=0)){o(s("pleaseEnterMaxWalletLimit"));return}if(e.enableSwapLimit&&(!e.maxSwapAmount||Number(e.maxSwapAmount)<=0)){o(s("pleaseEnterMaxSwapLimit"));return}}v.value=!0;let i=await(await F.wallet.contractTokenFactory(x.tokenFactoryAddress)).baseFee();console.log("baseFee",i),h.value=O(i);const r=await F.wallet.getBalance(c.walletAddress);if(console.log("balance",r),r<i){o(s("balanceSlow2",{chainMianCoin:c.chainCoinSymbol,amount:h.value})),v.value=!1;return}S.value=!0,v.value=!1}async function E(){A.value=!0;try{const t=await F.wallet.contractTokenFactory(x.tokenFactoryAddress);let d=await t.baseFee();const i=[],r=[],a=[],n=[];if(e.deployerId==0)i[0]=e.name,i[1]=e.symbol,a[0]=e.decimals,a[1]=p(e.totalSupply,e.decimals),n[0]=e.canMint;else if(e.deployerId==1){i[0]=e.name,i[1]=e.symbol;let u=e.token.tokenAddress,f=!1;u==="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"&&(u=(await(await F.wallet.contractSwap(e.chainSwap.routerAddress)).WETH()).toLowerCase(),f=!0),r[0]=u,r[1]=e.chainSwap.routerAddress,r[2]=c.walletAddress,r[3]=e.fundAddress?e.fundAddress:"0x0000000000000000000000000000000000000000",a[0]=e.decimals,a[1]=p(e.totalSupply,e.decimals),a[2]=l(e.buyFundFee).times(100).toNumber(),a[3]=l(e.buyBurnFee).times(100).toNumber(),a[4]=l(e.buyLPFee).times(100).toNumber(),a[5]=l(e.sellFundFee).times(100).toNumber(),a[6]=l(e.sellBurnFee).times(100).toNumber(),a[7]=l(e.sellLPFee).times(100).toNumber(),a[8]=e.killBlock?l(e.killBlock).toNumber():0,a[9]=e.maxSwapAmount?p(e.maxSwapAmount,e.decimals):0n,a[10]=e.maxWalletAmount?p(e.maxWalletAmount,e.decimals):0n,n[0]=e.canMint,n[1]=f,n[2]=e.enableManualStartTrade,n[3]=e.enableKillBlock,n[4]=e.enableSwapLimit,n[5]=e.enableWalletLimit,n[6]=e.enableChangeTax,n[7]=e.enableWhiteList}else if(e.deployerId==2){i[0]=e.name,i[1]=e.symbol;let u=e.token.tokenAddress,f=!1;u==="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"&&(u=(await(await F.wallet.contractSwap(e.chainSwap.routerAddress)).WETH()).toLowerCase(),f=!0),r[0]=u,r[1]=e.chainSwap.routerAddress,r[2]=c.walletAddress,r[3]=e.fundAddress?e.fundAddress:"0x0000000000000000000000000000000000000000",a[0]=e.decimals,a[1]=p(e.totalSupply,e.decimals),a[2]=l(e.buyFundFee).times(100).toNumber(),a[3]=l(e.buyRewardFee).times(100).toNumber(),a[4]=l(e.buyLPFee).times(100).toNumber(),a[5]=l(e.sellFundFee).times(100).toNumber(),a[6]=l(e.sellRewardFee).times(100).toNumber(),a[7]=l(e.sellLPFee).times(100).toNumber(),a[8]=e.killBlock?l(e.killBlock).toNumber():0,a[9]=e.maxSwapAmount?p(e.maxSwapAmount,e.decimals):0n,a[10]=e.maxWalletAmount?p(e.maxWalletAmount,e.decimals):0n,n[0]=f,n[1]=e.enableManualStartTrade,n[2]=e.enableKillBlock,n[3]=e.enableSwapLimit,n[4]=e.enableWalletLimit,n[5]=e.enableChangeTax,n[6]=e.enableWhiteList}else if(e.deployerId==3){i[0]=e.name,i[1]=e.symbol;let u=e.token.tokenAddress,f=!1;u==="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"&&(u=(await(await F.wallet.contractSwap(e.chainSwap.routerAddress)).WETH()).toLowerCase(),f=!0),r[0]=u,r[1]=e.chainSwap.routerAddress,r[2]=c.walletAddress,r[3]=e.fundAddress?e.fundAddress:"0x0000000000000000000000000000000000000000",r[4]=e.rewardToken,a[0]=e.decimals,a[1]=p(e.totalSupply,e.decimals),a[2]=l(e.buyFundFee).times(100).toNumber(),a[3]=l(e.buyRewardFee).times(100).toNumber(),a[4]=l(e.buyLPFee).times(100).toNumber(),a[5]=l(e.sellFundFee).times(100).toNumber(),a[6]=l(e.sellRewardFee).times(100).toNumber(),a[7]=l(e.sellLPFee).times(100).toNumber(),a[8]=e.killBlock?l(e.killBlock).toNumber():0,a[9]=e.maxSwapAmount?p(e.maxSwapAmount,e.decimals):0n,a[10]=e.maxWalletAmount?p(e.maxWalletAmount,e.decimals):0n,n[0]=f,n[1]=e.enableManualStartTrade,n[2]=e.enableKillBlock,n[3]=e.enableSwapLimit,n[4]=e.enableWalletLimit,n[5]=e.enableChangeTax,n[6]=e.enableWhiteList,n[7]=e.canMint}console.log(e.deployerId,i,r,a,n);const b=await t.tokenCreate(e.deployerId,i,r,a,n,{value:d});console.dir(b),e.txHash=b.hash,b.wait().then(async u=>{u.status===1&&o({type:"success",message:s("upChainSuccessfully")})}),_.value=!0}catch(t){if(console.log(JSON.stringify(t)),t.info&&t.info.error&&t.info.error.code===4001)o(s("userCancelOperate"));else if(t.error&&t.error.message&&t.error.message=="Canceled")o(s("userCancelOperate"));else if(t.data&&t.data.code==-32e3){const d=t.data.message.match(/(\d+) want (\d+)/)[2];o(s("balanceSlow2",{chainMianCoin:lmStore.token.chainCoinSymbol,amount:j(d)}))}else t.code==="INSUFFICIENT_FUNDS"?o(s("balanceSlow")):t.info&&t.info.error&&t.info.error.code==-32603&&t.info.error.data.message.endsWith("transfer amount exceeds balance")?o(s("balanceSlow2",{chainMianCoin:c.chainCoinSymbol,amount:h.value})):t.code=="CALL_EXCEPTION"&&t.info.error.message.endsWith("transfer amount exceeds balance")?o(s("balanceSlow2",{chainMianCoin:c.chainCoinSymbol,amount:h.value})):o(s("unkonwError"))}finally{S.value=!1,A.value=!1}}function W(){window.open(c.txBlockExplorerUrl+e.txHash,"_blank")}return U(()=>{console.log("create before mounted")}),(t,d)=>{const i=C("router-view"),r=C("van-action-bar-button"),a=C("van-action-bar"),n=C("van-popup");return D(),K("div",X,[y(i,{onCreateTokenClick:I,createTokenLoading:v.value},null,8,["createTokenLoading"]),y(n,{show:S.value,"onUpdate:show":d[0]||(d[0]=b=>S.value=b),round:"",closeable:"",class:"van-dialog van-dialog--round-button","close-on-click-overlay":!1},{default:g(()=>[m("div",q,w(t.$t("tokenCreationSoon")),1),m("div",z,[m("div",Q,[m("div",null,w(t.$t("createConfirmInfo")),1),m("div",Y,w(t.$t("serviceFeeCreation",{baseFeeAmount:h.value,baseFeeSymbol:L(c).chainCoinSymbol})),1)])]),y(a,{class:"van-dialog__footer"},{default:g(()=>[y(r,{type:"danger",loading:A.value,color:"#3F80F7",text:t.$t("confirmAndCreate"),class:"van-dialog__confirm",onClick:E},null,8,["loading","text"])]),_:1})]),_:1},8,["show"]),y(M,{show:_.value,"onUpdate:show":d[1]||(d[1]=b=>_.value=b),theme:"round-button",showCancelButton:!1,confirmButtonText:t.$t("enterTokenManagement"),onOnConfirm:d[2]||(d[2]=b=>L(B).push("/createToken"))},{default:g(()=>[m("div",null,[y(V,{name:"createSuccess",style:{width:"48px",height:"48px"}})]),m("div",Z,w(t.$t("createdSubmitted")),1),m("div",ee,[G(w(t.$t("inBrowser")),1),m("span",{class:"show",onClick:W},w(t.$t("view")),1)]),m("div",ae,w(t.$t("waitToView")),1)]),_:1},8,["show","confirmButtonText"])])}}};export{ie as default};
