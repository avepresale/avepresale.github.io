import{_ as U,u as Y,d as H,e as z,f as O,g as $,h as P,i as q,r as k,o as d,c as v,b as s,j as n,a as i,t as r,w as A,k as p,l as f,m as b,F as L,s as E,n as x,p as G,q as N,v as S,x as J,T as K,y as Q,z as X,A as C,B as Z,C as ee}from"./index-df1a018e.js";import{u as te}from"./create-93e1119d.js";import{D as oe}from"./DropDown-f98928bc.js";const se={class:"token-create"},ne={class:"tools-bar"},ae={class:"left"},le={key:0,class:"address"},re={class:"address-text"},ie={style:{"margin-left":"6px"}},de={class:"tools"},ce={class:"token-box"},ue={class:"token"},pe={class:"title"},ve=["onClick"],fe={class:"content"},ge={class:"name"},me={class:"create-time"},ke={key:1,class:"no-data"},he={class:"text"},_e={class:"bottom-operate"},ye={class:"content"},Ce={__name:"Index",setup(we){const{t:W}=Y(),l=H(),I=z(),R=te(),T=O(),g=$(0),h=$(10),a=P({pageNumber:0,tokenList:[],loading:!1,finished:!1,error:!1,refreshing:!1}),_=$(!1);function F(){R.$reset(),T.push("/createToken/create/basicInfo")}async function D(){l.walletAddress||E(W("pleaseConnectWallet"));try{let e=await x.tokenFactory.getTotalRecords(I.tokenFactoryAddress,l.walletAddress);g.value=Number(e)}catch(e){console.error(e)}finally{a.refreshing=!1}}async function w(){a.loading=!0;let e=G({duration:0}),t=(a.pageNumber*h.value).toString(),y=(a.pageNumber*h.value+h.value-1).toString();try{let c=await x.tokenFactory.getOwnRecords(I.tokenFactoryAddress,l.walletAddress,t,y);console.log(c);for(let u of c){let m={tokenAddress:u[6].toLowerCase(),createTime:Number(u[0]),symbol:u[4],name:u[3],deployerId:Number(u[5])};a.tokenList.push(m)}c.length<h.value||g.value==Number(y)+1?a.finished=!0:a.pageNumber++}catch(c){a.error=!0,console.log(c)}finally{e.close(),a.loading=!1,a.refreshing=!1}}async function M(){a.pageNumber=0,a.tokenList=[],a.finished=!1,await D(),g.value>0&&(console.log(g.value),w())}function V(e,t){T.push("/createToken/manage/"+e+"/"+t)}return q(()=>{let e=setInterval(async()=>{l.isConnectWallet&&(clearInterval(e),await D(),g.value>0&&w())},100)}),(e,t)=>{const y=k("van-list"),c=k("van-image"),u=k("van-pull-refresh"),m=k("van-button"),j=k("van-dialog");return d(),v(L,null,[s("div",se,[s("div",ne,[s("div",ae,[s("div",{onClick:t[0]||(t[0]=o=>n(l).showSelectDapp=!0)},[i(p,{class:"icon",name:"menu"})]),n(l).isConnectWallet?(d(),v("div",le,[i(oe,{class:"switch-chain",onClick:t[1]||(t[1]=o=>n(l).showSelectChainPopup=!0),error:!n(l).chainId,logo:n(l).chainIcon,value:n(l).chain.toUpperCase()},null,8,["error","logo","value"]),s("div",re,r(n(N)(n(l).walletAddress)),1),i(p,{class:"copy-icon",name:"copy",onClick:t[2]||(t[2]=A(o=>n(S)(n(l).walletAddress),["stop"]))})])):(d(),v("div",{key:1,class:"address",onClick:t[3]||(t[3]=(...o)=>n(l).connectWallet&&n(l).connectWallet(...o))},[i(p,{class:"icon",name:"wallet"}),s("div",ie,r(e.$t("pleaseConnectWallet")),1)]))]),s("div",de,[i(p,{class:"icon",name:"language",onClick:t[4]||(t[4]=o=>n(l).showLanguagePicker=!0)}),i(p,{class:"icon",name:"help",onClick:t[5]||(t[5]=o=>_.value=!0)})])]),s("div",ce,[s("div",ue,[s("div",pe,r(e.$t("myToken")),1),i(u,{modelValue:a.refreshing,"onUpdate:modelValue":t[9]||(t[9]=o=>a.refreshing=o),"pulling-text":e.$t("pulling"),"loosing-text":e.$t("loosing"),"loading-text":e.$t("loading"),onRefresh:M},{default:f(()=>[a.tokenList.length>0?(d(),b(y,{key:0,class:"token-list","loading-text":e.$t("loading"),loading:a.loading,"onUpdate:loading":t[6]||(t[6]=o=>a.loading=o),finished:a.finished,"finished-text":e.$t("noMore"),error:a.error,"onUpdate:error":t[7]||(t[7]=o=>a.error=o),"error-text":e.$t("errorText"),onLoad:t[8]||(t[8]=o=>w())},{default:f(()=>[(d(!0),v(L,null,J(a.tokenList,o=>(d(),v("div",{class:"item",onClick:B=>V(o.deployerId,o.tokenAddress)},[s("div",null,[i(K,{class:"token-icon",tokenIcon:n(Q)(n(l).chain.toLowerCase(),o.tokenAddress.toLowerCase()),chainIcon:n(X)(n(l).chain.toLowerCase())},null,8,["tokenIcon","chainIcon"]),s("div",fe,[s("div",ge,[s("span",null,r(o.symbol),1),s("span",null,"（"+r(o.name)+"）",1)]),s("div",null,[C(r(n(N)(o.tokenAddress))+" ",1),i(p,{class:"copy-icon",name:"copy",onClick:A(B=>n(S)(o.tokenAddress),["stop"])},null,8,["onClick"])]),s("div",me,r(n(Z).unix(o.createTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),s("div",null,[i(p,{class:"image",name:"arrow"})])],8,ve))),256))]),_:1},8,["loading-text","loading","finished","finished-text","error","error-text"])):(d(),v("div",ke,[i(c,{class:"image",src:"/assets/images/warn.png"}),s("div",he,r(e.$t("noToken")),1)]))]),_:1},8,["modelValue","pulling-text","loosing-text","loading-text"])])]),s("div",_e,[n(l).isConnectWallet?(d(),b(m,{key:0,type:"primary",round:"",block:"",class:"btn",onClick:F},{default:f(()=>[C(r(e.$t("createToken")),1)]),_:1})):(d(),b(m,{key:1,type:"primary",round:"",block:"",class:"btn",onClick:n(l).connectWallet},{default:f(()=>[C(r(e.$t("connectWallet")),1)]),_:1},8,["onClick"])),i(m,{type:"primary",round:"",block:"",plain:"",class:"btn"},{default:f(()=>[C(r(e.$t("viewTutorial")),1)]),_:1})])]),i(j,{class:"help-dialog",show:_.value,title:e.$t("rulesDescription"),"confirm-button-text":e.$t("understand"),onConfirm:t[10]||(t[10]=o=>_.value=!1),onClose:t[11]||(t[11]=o=>_.value=!1),"close-on-click-overlay":""},{default:f(()=>[s("div",ye,[s("div",null,r(e.$t("rulesDescription1",{chains:n(ee)[n(l).dappType].chainList.map(o=>o.chain.toUpperCase()).join("/")})),1),s("div",null,r(e.$t("rulesDescription2")),1),s("div",null,r(e.$t("rulesDescription3")),1),s("div",null,r(e.$t("rulesDescription4")),1),s("div",null,r(e.$t("rulesDescription5")),1)])]),_:1},8,["show","title","confirm-button-text"])],64)}}},Te=U(Ce,[["__scopeId","data-v-7afe3353"]]);export{Te as default};
