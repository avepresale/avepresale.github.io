import{_ as U,b as j,j as H,n as T,C as q,h as G,r as _,o as f,q as S,f as t,d as $,y as N,w as A,c as l,B as d,t as o,l as i,F as M,D as k,P as B,E as D,G as W}from"./index-e864de28.js";import{_ as y,f as I,c as L}from"./TokenIcon-138447c5.js";import{f as b,B as P}from"./dayjs.min-dab59b25.js";import{L as z,F as J}from"./Footer-038d69a2.js";import{_ as K}from"./Dialog-64046d7c.js";import{s as u}from"./function-call-ecde7c14.js";import"./Progress-2d546016.js";const Q={class:"lanuch-pad-manage"},X={class:"content"},Y={class:"operate"},Z={class:"status"},ee={key:0,class:"auditing"},ae={key:1,class:"fail"},se={class:"notes"},te={class:"support"},ne={class:"dialog-content"},oe={__name:"Index",setup(re){const F=j("global"),{t:r}=H(),g=T(!1),m=q(),V=G();async function O(){if(!n.value)return;if(await(await k.wallet.contract(n.value.contractAddress,B)).isFunderChanged()){u(r("onlyOneChange"));return}g.value=!0}function R(){g.value=!1}async function x(){if(/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(p.value)){const s=D({message:r("changingAddress")+"...",forbidClick:!0,duration:0});try{const a=await k.wallet.contract(n.value.contractAddress,B);if(await a.funder()==p.value){u(r("receivingAddressLimit"));return}if(n.value.contractCreator!==V.walletAddress){u(r("notCreator"));return}(await(await a.changeFunder(p.value)).wait()).status===1&&(u({type:"success",message:r("changeAddressSuccess")}),g.value=!1,p.value="")}catch(a){console.log(a),a.info&&a.info.error&&a.info.error.code===4001?u(r("userCancelOperate")):a.error&&a.error.message&&a.error.message=="Canceled"?u(r("userCancelOperate")):u(r("unkonwError"))}finally{s.close()}}else u(r("inputCorrectAddress"))}const n=T(null),p=T("");async function E(){const s=D({message:r("getDetail")+"...",forbidClick:!0,duration:0});try{let a=await k.presale.getPresale(m.params.chain,m.params.contractAddress);if(a.status!=1)throw a.msg;let e=a.data,v=b(e.hardCap,Number(e.baseTokenDecimal)),h=b(e.softCap,Number(e.baseTokenDecimal)),w=P(e.salePrice).div("1000000").toString(),c=b(e.saleAmount,Number(e.baseTokenDecimal)),C=b(await k.wallet.getCumulateAmount(e.contractAddress),Number(e.tokenDecimal));n.value={isMine:!0,approveStatus:e.approveStatus,chain:m.params.chain,status:e.status,contractAddress:e.contractAddress,contractCreator:e.contractCreator,tokenAddress:e.tokenAddress,tokenName:e.tokenName,tokenSymbol:e.tokenSymbol,hardCap:v,softCap:h,baseTokenAddress:e.baseTokenAddress,baseTokenName:e.baseTokenName,baseTokenSymbol:e.baseTokenSymbol,baseTokenDecimal:e.baseTokenDecimal,startTime:e.startTime,endTime:e.endTime,endSaleTime:e.endSaleTime,endSaleTxHash:e.endSaleTxHash,salePrice:w,saleAmount:c,cumulateAmount:C,progressRate:P(C).div(v).multipliedBy(100).toNumber()}}catch(a){console.log(a)}finally{s.close()}}return E(),(s,a)=>{const e=_("van-button"),v=_("van-icon"),h=_("van-field"),w=_("van-cell-group");return f(),S(M,null,[t("div",Q,[t("div",X,[n.value?(f(),$(z,{key:0,presaleItem:n.value},null,8,["presaleItem"])):N("",!0),t("div",Y,[n.value&&n.value.approveStatus!=1?(f(),$(e,{key:0,class:"btn unactive",type:"primary"},{default:A(()=>[d(o(s.$t("changeReceivingAddress")),1)]),_:1})):(f(),$(e,{key:1,class:"btn",type:"primary",onClick:O},{default:A(()=>[d(o(s.$t("changeReceivingAddress")),1)]),_:1}))]),t("div",Z,[n.value&&n.value.approveStatus==0?(f(),S("div",ee,[l(v,{name:"clock"}),d(o(s.$t("reviewWait"))+"~",1)])):N("",!0),n.value&&n.value.approveStatus==2?(f(),S("div",ae,[l(v,{name:"warning"}),d(o(s.$t("auditFailed"))+"~",1)])):N("",!0)]),t("div",se,[t("div",null,o(s.$t("importantNote")),1),t("div",null,o(s.$t("noteInfo")),1),t("div",null,[d(o(i(I)(i(F).cfg.allowChainList.find(c=>c.chain==i(m).params.chain).presaleFactoryAddress.toLowerCase(),8))+" ",1),l(y,{name:"copy",onClick:a[0]||(a[0]=c=>i(L)(i(F).cfg.allowChainList.find(C=>C.chain==i(m).params.chain).presaleFactoryAddress.toLowerCase()))})]),t("div",null,[d(o(i(I)(i(m).params.contractAddress,8))+" ",1),l(y,{name:"copy",onClick:a[1]||(a[1]=c=>i(L)(i(m).params.contractAddress))})])]),t("div",te,[t("div",null,[d(o(s.$t("technicalSupport"))+": ",1),l(y,{class:"icon",name:"telegramBlue"})]),t("div",null,[d(o(s.$t("uploadFile"))+": ",1),l(y,{class:"icon",name:"telegramBlue"})])])]),l(J)]),l(K,{show:g.value,"onUpdate:show":a[3]||(a[3]=c=>g.value=c),title:s.$t("changeReceivingAddress"),confirmText:s.$t("confirmChange"),cancelText:s.$t("cancel"),onConfirmClick:x,onCancelClick:R},{default:A(()=>[W(s.$slots,"default",{},()=>[t("div",ne,[t("text",null,"*"+o(s.$t("onlyOneChange")),1),l(w,{class:"cell",inset:""},{default:A(()=>[l(h,{class:"input",modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=c=>p.value=c),clearable:"",placeholder:s.$t("receiveAddressPrompt")},null,8,["modelValue","placeholder"])]),_:1})])],!0)]),_:3},8,["show","title","confirmText","cancelText"])],64)}}},ve=U(oe,[["__scopeId","data-v-5840e795"]]);export{ve as default};
