import{_ as K,f as Q,Q as G,d as H,$ as J,u as X,g as m,K as Y,C as M,i as Z,r as g,o as r,c as h,a as p,b as s,M as $,t as i,F as T,x as R,j as a,l as S,a4 as ee,n as _,m as E,T as N,z as te,q as O,y as B,I as oe,p as se}from"./index-b9baa0a4.js";import{B as I}from"./bignumber-3e8dfdf6.js";const ne={class:"body"},ae={class:"content"},le={class:"type"},ce={class:"network"},ie={class:"network-list"},re=["onClick"],de={class:"item-left"},ue={class:"left-content"},ke={class:"token-name"},ve={class:"token-address"},he={class:"token"},_e={class:"left-content"},fe={class:"token-name"},me={class:"token-address"},pe={class:"item-right"},Ce={class:"item-right-left"},we={class:"qty"},ye={class:"amount"},Le={class:"item-right-right"},F="/lockMaster/create",be={__name:"SelectToken",setup(ge){const x=Q();G();const v=H(),C=J(),{t:D}=X(),w=m([]),d=m([]),l=m(""),u=m(0),U=Y(()=>u.value==0?l.value?l.value.startsWith("0x")?w.value.filter(e=>e.address.toLowerCase()==l.value.toLowerCase()):w.value.filter(e=>e.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):w.value:u.value==1?l.value?l.value.startsWith("0x")?d.value.filter(e=>e.address.toLowerCase()==l.value.toLowerCase()):d.value.filter(e=>e.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):d.value:[]),y=M.chainList.filter(e=>M[v.dappType].chainList.map(n=>n.chain).some(n=>n==e.chain)),c=m(y.find(e=>e.chain==v.chain)?y.find(e=>e.chain==v.chain):y[0]);async function W(e){c.value.chain!=e.chain&&(c.value=e,V(),await _.wallet.switchNetwork(c.value.chainId))}async function V(){const e=se({message:"Loading...",forbidClick:!0,duration:0}),n=await _.debank.getTokenList(v.walletAddress,c.value.chain);let k=[],f=[];for(let t of n.data.data){if(t.token=="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"){t.token=_.wallet.MAIN_COIN_ADDRESS;continue}if(new RegExp("^0x.*$","gi").test(t.token)&&t.value>0&&t.risk_score<60&&t.risk_level>=0&&t.flag!=="blacklist"&&t.symbol!==""){if(t.token=="0xc748673057861a797275cd8a068abb95a902e8de")continue;t.flag=="lp"?f.push({tokenList:[{address:"",symbol:""},{address:"",symbol:""}],symbol:"",address:t.token.toLowerCase(),tokenId:`${t.token}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),decimals:t.decimals,amount:t.value,price:t.current_price_usd,hasTokenInfo:!1,tokenType:1,chainCoinSymbol:c.value.nativeCurrency.symbol,name:t.name}):k.push({address:t.token.toLowerCase(),tokenId:`${t.token}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:B(t.chain.toLowerCase(),t.token.toLowerCase()),amount:t.value,price:t.current_price_usd,tokenType:0,chainCoinSymbol:c.value.nativeCurrency.symbol,name:t.name})}}w.value=k,d.value=f,e.close()}function q(e){C.token=e,C.prevPath.toLowerCase()==F.toLowerCase()?x.back():x.push(F)}function z(){x.push(F)}async function P(){console.log("init"),v.isConnectWallet&&await V()}function A(e){u.value!=e&&(u.value=e,e===1&&j())}async function j(){if(d.value.length!=0){if(c.value.chainId!=v.chainId){ee(D("switchTrueChain",{cahin:c.value.chain})),d.value=[];return}for(let e of d.value)if(e.hasTokenInfo==!1){let n=await _.wallet.contractLP(e.address),k=await n.token0(),t=await(await _.wallet.contractERC20(k)).symbol(),L=await n.token1(),b=await(await _.wallet.contractERC20(L)).symbol();e.tokenList[0]={symbol:t.toUpperCase(),address:k.toLowerCase()},e.tokenList[1]={symbol:b.toUpperCase(),address:L.toLowerCase()},e.symbol=`${t}/${b}`}}}return Z(()=>{console.log("onMounted"),P()}),(e,n)=>{const k=g("van-search"),f=g("van-icon"),t=g("van-cell"),L=g("van-list");return r(),h("div",ne,[p(k,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=o=>l.value=o),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel"),onCancel:z},null,8,["modelValue","placeholder","action-text"]),s("div",ae,[s("div",le,[s("div",{class:$({select:u.value==0}),onClick:n[1]||(n[1]=o=>A(0))},i(e.$t("myToken")),3),s("div",{class:$({select:u.value==1}),onClick:n[2]||(n[2]=o=>A(1))},i(e.$t("myLp")),3)]),s("div",ce,[s("ul",ie,[(r(!0),h(T,null,R(a(y),o=>(r(),h("li",{class:$(c.value.chain==o.chain?"network-selected":""),onClick:b=>W(o)},i(o.chain.toUpperCase()),11,re))),256))])]),s("div",null,[p(L,{"finished-text":e.$t("noMore"),class:"token-list"},{default:S(()=>[(r(!0),h(T,null,R(U.value,o=>(r(),E(t,{class:"item",key:o,onClick:b=>q(o)},{title:S(()=>[s("div",de,[u.value==0?(r(),h(T,{key:0},[p(N,{class:"token-icon-1",tokenIcon:o.icon,chainIcon:a(te)(o.chain)},null,8,["tokenIcon","chainIcon"]),s("div",ue,[s("div",ke,i(o.symbol),1),s("div",ve,i(a(O)(o.address)),1)])],64)):(r(),h(T,{key:1},[s("div",he,[p(N,{class:"token-icon-2",tokenIcon:a(B)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),p(N,{class:"token-icon-2",tokenIcon:a(B)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"])]),s("div",_e,[s("div",fe,i(o.symbol),1),s("div",me,i(a(O)(o.address)),1)])],64))])]),value:S(()=>[s("div",pe,[s("div",Ce,[s("div",we,i(a(I)(o.amount).toString().indexOf(".")==-1?a(I)(o.amount):a(I)(o.amount).toFixed(6,1)),1),s("div",ye,"$"+i(a(I)(o.amount).multipliedBy(o.price).toFixed(2,1)),1)]),s("div",Le,[a(C).token&&a(C).token.address==o.address?(r(),E(f,{key:0,name:"success",color:"#3F80F7"})):oe("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},xe=K(be,[["__scopeId","data-v-970b3b55"]]);export{xe as default};
