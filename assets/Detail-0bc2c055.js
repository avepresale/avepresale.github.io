import{_ as q,u as H,d as P,W as j,g as L,h as z,i as G,r as D,o as r,c as m,a as u,j as s,T,A as p,t,m as A,I as _,b as e,k as N,l as $,F as W,n as k,Z,B as g,y as V,q as I,z as J,v as U,Y as K,M as O,N as Q}from"./index-423f5c8f.js";import{E as X}from"./EditPopup-d5323452.js";import"./OperateSuccessDialog-084525c8.js";import{e as oo}from"./ethers-e7d19ac2.js";import"./bignumber-3e8dfdf6.js";/* empty css                                                         */import{f as Y}from"./units-31c71a12.js";const eo=y=>(O("data-v-35ae3098"),y=y(),Q(),y),to={key:0,class:"body"},so={key:0,class:"token"},ao={key:1,class:"token"},no={class:"info"},io={class:"item"},lo={class:"key"},co={class:"value"},ro={key:0,class:"item"},ko={class:"key"},mo={class:"value"},uo={class:"item"},po={class:"key"},_o={class:"value"},yo={class:"item"},vo={class:"key"},ho={key:0,class:"value"},wo={key:1,class:"value"},fo={class:"item"},bo={class:"key"},Co={class:"value"},Lo={class:"blue-font"},go={class:"item"},Io={class:"key"},So={class:"value"},Do={class:"item"},To={class:"key"},$o={class:"value"},Vo=eo(()=>e("div",{class:"footer"},null,-1)),Eo={__name:"Detail",props:{lockId:String,tokenType:String,version:String},setup(y){const a=y,{t:F}=H(),b=P(),E=j(),C=L(!1),o=z({id:a.lockId,address:"",amountString:"",tokenList:[],lockDate:0,unlockDate:0,isLpToken:!1,symbol:"",chain:"",isExpired:!1,chainCoinSymbol:"",decimals:0}),S=L(!1);L(!1);async function x(){C.value=!1;let i;a.version=="V2"?i=await k.wallet.contractTokenLockV2(E.tokenLockV2Address):a.version=="V3"&&(i=await k.wallet.contractTokenLockV3(E.tokenLockV3Address)),console.dir(i);let l;try{console.log(a.lockId),l=await i.getLockById(a.lockId)}catch{Z(F("failedToGetDetail"));return}if(o.lockDate=Number(l[4]),o.unlockDate=Number(l[5]),o.tokenId=l.tokenId,o.address=l[1],o.owner=l[2],o.isExpired=g().unix()>=o.unlockDate,o.chain=b.chain,o.chainCoinSymbol=b.chainCoinSymbol,a.tokenType=="lpToken"){if(a.version=="V2")try{const n=await k.wallet.contractLP(o.address);let c=await n.decimals();o.decimals=c;let d=await n.token0(),h=await(await k.wallet.contractERC20(d)).symbol(),w=await n.token1(),f=await(await k.wallet.contractERC20(w)).symbol();o.isLpToken=!0,o.tokenList[0]={symbol:h.toUpperCase(),address:d.toLowerCase()},o.tokenList[1]={symbol:f.toUpperCase(),address:w.toLowerCase()},o.amountString=Y(l[3],c),o.symbol=`${h}/${f}`}catch(n){console.log(n)}else if(a.version=="V3")try{let c=await(await k.wallet.contractNFT(o.address)).positions(o.tokenId);console.log(c.token0);let d=c.token0,h=await(await k.wallet.contractERC20(d)).symbol(),w=c.token1,f=await(await k.wallet.contractERC20(w)).symbol();o.isLpToken=!0,o.tokenList[0]={symbol:h.toUpperCase(),address:d.toLowerCase()},o.tokenList[1]={symbol:f.toUpperCase(),address:w.toLowerCase()},o.liquidity=c.liquidity,o.symbol=`${h}/${f}`}catch(n){console.log(n)}}else if(a.tokenType=="token")try{const n=await k.wallet.contractERC20(o.address);let c=await n.symbol(),d=await n.decimals();o.decimals=d,o.tokenList=[],o.isLpToken=!1,o.symbol=c.toUpperCase(),o.amountString=Y(l[3],d)}catch(n){console.log(n)}C.value=!0,console.log("getDetailDone")}function B(){console.log(o),S.value=!0}function M(){window.location.reload()}return G(()=>{x()}),L(!0),console.log(a.lockId),console.log(a.tokenType),(i,l)=>{const n=D("van-icon"),c=D("van-button"),d=D("van-action-bar");return r(),m(W,null,[C.value?(r(),m("div",to,[o.isLpToken?(r(),m("div",so,[u(T,{class:"token-icon",tokenIcon:s(V)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),u(T,{class:"token-icon",tokenIcon:s(V)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),p(" "+t(`${o.symbol} (${s(I)(o.address)})`),1)])):(r(),m("div",ao,[o.address?(r(),A(T,{key:0,class:"token-icon",tokenIcon:s(V)(o.chain,o.address.toLowerCase()),chainIcon:s(J)(o.chain)},null,8,["tokenIcon","chainIcon"])):_("",!0),p(" "+t(`${o.symbol} (${s(I)(o.address)})`),1)])),e("ul",no,[e("li",io,[e("div",lo,t(i.$t("contractAddress")),1),e("div",co,[p(t(s(I)(o.address))+" ",1),u(N,{class:"copy-icon",name:"copy",onClick:l[0]||(l[0]=v=>s(U)(o.address))})])]),a.version=="V3"?(r(),m("li",ro,[e("div",ko,t(i.$t("tokenID")),1),e("div",mo,t(a.lockId),1)])):_("",!0),e("li",uo,[e("div",po,t(i.$t("contractChian")),1),e("div",_o,t(o.chain.toUpperCase()),1)]),e("li",yo,[e("div",vo,t(`${o.symbol} ${i.$t("lockNumber")}`),1),a.version=="V2"?(r(),m("div",ho,t(o.amountString),1)):_("",!0),a.version=="V3"?(r(),m("div",wo,t(s(oo).formatEther(o.liquidity.toString())),1)):_("",!0)]),e("li",fo,[e("div",bo,t(i.$t("unlockTime2")),1),e("div",Co,[e("span",null,t(s(g).unix(o.unlockDate).format("YYYY-MM-DD HH:mm:ss")),1),e("span",null,[p("("),e("span",Lo,t(o.isExpired?i.$t("expired"):i.$t("dayLeft",{day:s(K)(s(g).unix(o.unlockDate).toDate())})),1),p(")")])])]),e("li",go,[e("div",Io,t(i.$t("lockUser")),1),e("div",So,[p(t(s(I)(o.owner))+" ",1),u(N,{class:"copy-icon",name:"copy",onClick:l[1]||(l[1]=v=>s(U)(o.owner))})])]),e("li",Do,[e("div",To,t(i.$t("lockTime")),1),e("div",$o,t(s(g).unix(o.lockDate).format("YYYY-MM-DD HH:mm:ss")),1)])])])):_("",!0),Vo,!o.isExpired&&C.value&&s(b).walletAddress&&o.owner.toLowerCase()==s(b).walletAddress.toLowerCase()?(r(),A(d,{key:1,class:"tools"},{default:$(()=>[u(c,{class:"btn",color:"#9F3FF7",onClick:B},{icon:$(()=>[u(n,{name:"edit"})]),default:$(()=>[p(t(i.$t("edit")),1)]),_:1}),u(X,{show:S.value,"onUpdate:show":l[2]||(l[2]=v=>S.value=v),onSuccess:M,isLockV2:a.version=="V2",lockId:o.id,isLpToken:o.isLpToken,chain:o.chain,unlockDate:o.unlockDate,tokenList:o.tokenList,symbol:o.symbol,address:o.address,chainCoinSymbol:o.chainCoinSymbol,amountString:o.amountString,decimals:o.decimals},null,8,["show","isLockV2","lockId","isLpToken","chain","unlockDate","tokenList","symbol","address","chainCoinSymbol","amountString","decimals"])]),_:1})):_("",!0)],64)}}},Mo=q(Eo,[["__scopeId","data-v-35ae3098"]]);export{Mo as default};
