import{D as C}from"./Dialog-09684fb2.js";import{_ as x,u as S,d as k,f as W,L as g,g as i,r as v,o as E,c as B,b as O,a as c,l as _,j as V,F as $,q as H,s as o,n as L,A as M,t as N,v as T}from"./index-0d96928c.js";import{u as U}from"./manage-ca0fa25b.js";import{a as D,f as F}from"./units-c9848000.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const I={class:"mint-token"},j={__name:"EditMaxWalletAmount",setup(q){const{t:a}=S(),h=k();W();const s=U(),w=g(()=>h.walletAddress.toLowerCase()===s.owner.toLowerCase()),m=i(""),n=i(s.maxWalletAmount),y=g(()=>a("operationHash",{hash:H(m.value)})),d=i(!1),l=i(!1);function b(t){return t.replace("-","")}async function A(){if(!n.value){o(a("amountEmpty"));return}if(n.value.replace(".","").length>34){o(a("amountOver"));return}let t=n.value.split(".");if(t[1]&&t[1].length>s.decimals){o(a("amountOver"));return}l.value=!0;try{const e=await L.wallet.contract(s.tokenAddress,s.abi);let r=await e.changeWalletLimit(D(n.value,s.decimals));o({type:"success",message:a("submitSuccess")}),m.value=r.hash,d.value=!0,r.wait().then(async p=>{if(p.status===1){o({type:"success",message:a("upChainSuccessfully")});let f=await e.maxWalletAmount();s.maxWalletAmount=F(f.toString(),s.decimals),l.value=!1}})}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?o(a("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?o(a("userCancelOperate")):o(a("unkonwError")),l.value=!1}finally{}}return(t,e)=>{const r=v("van-field"),p=v("van-cell-group"),f=v("van-button");return E(),B($,null,[O("div",I,[c(p,{inset:""},{default:_(()=>[c(r,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=u=>n.value=u),"label-width":"10em",type:"number",label:t.$t("walletAmount"),placeholder:t.$t("pleaseEnter"),formatter:b,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),c(f,{type:"primary",round:"",block:"",class:"btn",onClick:A,loading:l.value,disabled:!w.value},{default:_(()=>[M(N(t.$t("submit")),1)]),_:1},8,["loading","disabled"])]),c(C,{show:d.value,"onUpdate:show":e[1]||(e[1]=u=>d.value=u),title:t.$t("submitSuccess"),message:y.value,showCancelButton:!1,confirmButtonText:t.$t("copyHash"),onOnConfirm:e[2]||(e[2]=u=>V(T)(m.value))},null,8,["show","title","message","confirmButtonText"])],64)}}},Q=x(j,[["__scopeId","data-v-cf1685d1"]]);export{Q as default};
