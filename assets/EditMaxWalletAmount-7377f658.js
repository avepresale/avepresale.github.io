import{D as x}from"./Dialog-9334f072.js";import{_ as C,u as S,d as W,f as k,L as g,g as i,r as v,o as E,c as $,b as B,a as m,l as _,j as O,F as V,q as H,s as o,n as L,A as M,t as N,v as T}from"./index-ef9f90dd.js";import{u as U}from"./manage-fd049987.js";import{a as D,f as F}from"./units-69fd59a3.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const I={class:"mint-token"},j={__name:"EditMaxWalletAmount",setup(q){const{t:s}=S(),h=W();k();const a=U(),w=g(()=>h.walletAddress.toLowerCase()===a.owner.toLowerCase()),c=i(""),n=i(a.maxWalletAmount);a.$subscribe((t,e)=>{n.value=a.maxWalletAmount});const b=g(()=>s("operationHash",{hash:H(c.value)})),d=i(!1),l=i(!1);function y(t){return t.replace("-","")}async function A(){if(!n.value){o(s("amountEmpty"));return}if(n.value.replace(".","").length>34){o(s("amountOver"));return}let t=n.value.split(".");if(t[1]&&t[1].length>a.decimals){o(s("amountOver"));return}l.value=!0;try{const e=await L.wallet.contract(a.tokenAddress,a.abi);let r=await e.changeWalletLimit(D(n.value,a.decimals));o({type:"success",message:s("submitSuccess")}),c.value=r.hash,d.value=!0,r.wait().then(async p=>{if(p.status===1){o({type:"success",message:s("upChainSuccessfully")});let f=await e.maxWalletAmount();a.maxWalletAmount=F(f.toString(),a.decimals),l.value=!1}})}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?o(s("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?o(s("userCancelOperate")):o(s("unkonwError")),l.value=!1}finally{}}return(t,e)=>{const r=v("van-field"),p=v("van-cell-group"),f=v("van-button");return E(),$(V,null,[B("div",I,[m(p,{inset:""},{default:_(()=>[m(r,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=u=>n.value=u),"label-width":"10em",type:"number",label:t.$t("walletAmount"),placeholder:t.$t("pleaseEnter"),formatter:y,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),m(f,{type:"primary",round:"",block:"",class:"btn",onClick:A,loading:l.value,disabled:!w.value},{default:_(()=>[M(N(t.$t("submit")),1)]),_:1},8,["loading","disabled"])]),m(x,{show:d.value,"onUpdate:show":e[1]||(e[1]=u=>d.value=u),title:t.$t("submitSuccess"),message:b.value,showCancelButton:!1,confirmButtonText:t.$t("copyHash"),onOnConfirm:e[2]||(e[2]=u=>O(T)(c.value))},null,8,["show","title","message","confirmButtonText"])],64)}}},Q=C(j,[["__scopeId","data-v-31b134f3"]]);export{Q as default};
