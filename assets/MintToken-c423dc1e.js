import{D as F}from"./Dialog-7bef48a5.js";import{_ as M,u as U,d as E,l as x,O as C,e as d,i as h,r as w,o as D,c as H,b as L,a as r,w as m,f as b,F as N,s as o,v as I,L as W,M as R,C as j,t as q,y as z}from"./index-a59c7a36.js";import{u as G}from"./manage-4248302c.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const J={class:"mint-token"},K={__name:"MintToken",setup(P){const{t:l}=U(),_=E(),k=x(),t=G(),A=C(()=>_.walletAddress.toLowerCase()===t.owner.toLowerCase()),f=d(""),s=d(_.walletAddress),u=d(""),S=C(()=>l("operationHash",{hash:h(f.value)})),v=d(!1),g=d(!1);function V(a){return a.replace("-","")}async function $(){if(!u.value){o(l("amountEmpty"));return}if(u.value.replace(".","").length>34){o(l("amountOver"));return}let a=u.value.split(".");if(a[1]&&a[1].length>t.decimals){o(l("amountOver"));return}if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(s.value)){o(l("addressWrong"));return}g.value=!0;try{const e=await I.wallet.contract(t.tokenAddress,t.abi);let i=await e.mint(s.value,W(u.value,t.decimals));f.value=i.hash,i.wait().then(async p=>{if(p.status===1){o({type:"success",message:l("upChainSuccessfully")});let y=await e.totalSupply();t.totalSupply=R(y.toString(),t.decimals),u.value=""}}),v.value=!0}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?o(l("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?o(l("userCancelOperate")):o(l("unkonwError"))}finally{g.value=!1}}async function T(){k.push("/createToken/manage/"+t.deployerId+"/"+t.tokenAddress)}const c=d(s.value?h(s.value):"");function B(){c.value=s.value}function O(){s.value=c.value,/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(s.value)?c.value=h(s.value):o(l("addressWrong"))}return(a,e)=>{const i=w("van-field"),p=w("van-cell-group"),y=w("van-button");return D(),H(N,null,[L("div",J,[r(p,{inset:""},{default:m(()=>[r(i,{modelValue:b(t).totalSupply,"onUpdate:modelValue":e[0]||(e[0]=n=>b(t).totalSupply=n),readonly:"",label:a.$t("currentTotal"),"input-align":"right"},null,8,["modelValue","label"])]),_:1}),r(p,{inset:""},{default:m(()=>[r(i,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),"label-width":"7em",type:"number",label:a.$t("mintTokenAmount"),placeholder:a.$t("pleaseEnter"),formatter:V,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(p,{inset:""},{default:m(()=>[r(i,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value=n),onFocus:B,onBlur:O,"label-width":"9em",label:a.$t("receivingAddress"),placeholder:a.$t("pleaseEnter"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(y,{type:"primary",round:"",block:"",class:"btn",onClick:$,loading:g.value,disabled:!A.value},{default:m(()=>[j(q(a.$t("submitAdd")),1)]),_:1},8,["loading","disabled"])]),r(F,{show:v.value,"onUpdate:show":e[3]||(e[3]=n=>v.value=n),title:a.$t("submitAddSuccessfully"),message:S.value,showCancelButton:!1,confirmButtonText:a.$t("copyHash"),onOnConfirm:e[4]||(e[4]=n=>b(z)(f.value)),onOnCancel:T},null,8,["show","title","message","confirmButtonText"])],64)}}},ae=M(K,[["__scopeId","data-v-7b767d32"]]);export{ae as default};
