import{_ as P,d as E,$ as M,u as O,g as h,B as u,J as Y,r as T,o as f,c as g,a as r,l as V,b as a,t as n,T as b,j as d,y as S,A as p,q as A,z as U,a2 as j,a0 as q,I as z,F as J,p as x,n as k,s as B,E as C}from"./index-2dc1edc6.js";import{S as K,O as Q}from"./OperateSuccessDialog-a3074a61.js";const _o="/assets/images/pinkswap.png";const R={class:"ave-popup"},W={class:"title"},X={class:"body"},Z={key:0,class:"info"},oo={class:"key"},ao={class:"value"},eo={key:0,class:"token"},so={key:1,class:"token"},to={class:"key"},no={class:"value"},lo={class:"blue-font"},co={class:"key"},io={class:"value"},uo={class:"key"},ro={class:"value"},ko={class:"select-date"},vo={class:"key"},ho={__name:"DelayPopup",props:{show:Boolean,lockId:String,isLockV2:Boolean,isLpToken:Boolean,unlockDate:Number,tokenList:Array,symbol:String,address:String,chainCoinSymbol:String,amountString:String,chain:String,decimals:Number},emits:["update:show","success"],setup(I,{emit:v}){const o=I,L=E(),m=M(),{t:$}=O(),t=h(0n),_=h(u.unix(o.unlockDate).toDate()),y=h(""),w=h(!1),D=h("");async function F(){console.log("estimateGas");const e=u.unix(o.unlockDate).add(1,"day").unix(),l=await k.wallet.getGasPrice(),c=await k.wallet.getBalance(L.walletAddress);console.log("balance",c);let s;if(o.isLockV2){const i=await k.wallet.contractTokenLockV2(m.tokenLockV2Address);if(t.value=await i.editFee(),c<t.value){B($("balanceSlow2",{chainMianCoin:L.chainCoinSymbol,amount:C(t.value)})),v("update:show",!1);return}s=await i.editLock.estimateGas(o.lockId,0n,e,{value:t.value})}else{const i=await k.wallet.contractTokenLockV3(m.tokenLockV3Address);if(t.value=await i.editFee(),c<t.value){B($("balanceSlow2",{chainMianCoin:L.chainCoinSymbol,amount:C(t.value)})),v("update:show",!1);return}s=await i.editLock.estimateGas(o.lockId,e,{value:t.value})}console.dir(s),y.value=C(s*l).toString(),console.log(y.value)}async function N(){const e=x({message:"Loading...",forbidClick:!0,duration:0}),l=u(_.value).unix();if(o.isLockV2){const c=await k.wallet.contractTokenLockV2(m.tokenLockV2Address);try{t.value=await c.editFee();let s=await c.editLock(o.lockId.toString(),0n,l,{value:t.value});console.dir(s),D.value=s.hash,w.value=!0}catch(s){console.log(s)}finally{e.close()}}else{const c=await k.wallet.contractTokenLockV3(m.tokenLockV3Address);try{t.value=await c.editFee();let s=await c.editLock(o.lockId.toString(),l,{value:t.value});console.dir(s),D.value=s.hash,w.value=!0}catch(s){console.log(s)}finally{e.close()}}}async function G(){const e=x({message:"Loading...",forbidClick:!0,duration:0});_.value=u.unix(o.unlockDate).add(1,"day").endOf("day").toDate(),await F(),e.close()}Y(()=>o.show,(e,l)=>{e&&G()});function H(){v("update:show",!1),v("success")}return(e,l)=>{const c=T("van-button"),s=T("van-popup");return f(),g(J,null,[r(s,{show:I.show,"onUpdate:show":l[1]||(l[1]=i=>{v("update:show",i)}),round:"",closeable:"",position:"bottom"},{default:V(()=>[a("div",R,[a("div",W,n(e.$t("delayLock")),1),a("div",X,[o.chain?(f(),g("ul",Z,[a("li",null,[a("div",oo,n(e.$t("lockAssets")),1),a("div",ao,[o.isLpToken?(f(),g("div",eo,[r(b,{class:"token-icon",tokenIcon:d(S)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),r(b,{class:"token-icon",tokenIcon:d(S)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),p(" "+n(`${o.symbol} (${d(A)(o.address)})`),1)])):(f(),g("div",so,[r(b,{class:"token-icon",tokenIcon:d(S)(o.chain,o.address),chainIcon:d(U)(o.chain)},null,8,["tokenIcon","chainIcon"]),p(" "+n(`${o.symbol} (${d(A)(o.address)})`),1)]))])]),a("li",null,[a("div",to,n(e.$t("unlockTime")),1),a("div",no,[a("span",null,n(d(u).unix(o.unlockDate).format("YYYY-MM-DD HH:mm:ss")),1),a("span",null,[p("("),a("span",lo,n(e.$t("dayLeft",{day:d(j)(d(u).unix(o.unlockDate).toDate())})),1),p(")")])])]),a("li",null,[a("div",co,n(e.$t("editFee")),1),a("div",io,n(`${t.value?d(q).formatEther(t.value):"--"} ${o.chainCoinSymbol}`),1)]),a("li",null,[a("div",uo,n(e.$t("gas")),1),a("div",ro,n(`${y.value?y.value:"--"} ${o.chainCoinSymbol}`),1)])])):z("",!0),a("div",ko,[a("div",vo,n(e.$t("setDelayDate")),1),r(K,{date:_.value,"onUpdate:date":l[0]||(l[0]=i=>_.value=i),"min-date":d(u).unix(o.unlockDate).add(1,"day").endOf("day").toDate()},null,8,["date","min-date"])]),r(c,{class:"btn",type:"primary",block:"",onClick:N},{default:V(()=>[p(n(e.$t("confirmAndLock")),1)]),_:1})])])]),_:1},8,["show"]),r(Q,{show:w.value,"onUpdate:show":l[2]||(l[2]=i=>w.value=i),txHash:D.value,onClose:H},null,8,["show","txHash"])],64)}}},yo=P(ho,[["__scopeId","data-v-1a4d7746"]]);export{yo as D,_o as _};
