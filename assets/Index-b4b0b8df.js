import{_ as Y,u as z,d as H,e as O,f as P,g as b,h as q,i as E,r as f,o as c,c as p,b as n,j as t,a as i,t as r,w as L,k as u,l as m,m as I,F as N,s as G,n as F,p as J,q as S,v as W,x as K,T as Q,y as X,z as Z,A as T,B as ee,C as k,D as te}from"./index-88c419c5.js";import{u as oe}from"./create-b1325351.js";import{D as se}from"./DropDown-149603e9.js";const ne={class:"token-create"},ae={class:"tools-bar"},le={class:"left"},re={key:0,class:"address"},ie={class:"address-text"},ce={style:{"margin-left":"6px"}},de={class:"tools"},ue={class:"token-box"},pe={class:"token"},ge={class:"title"},ve=["onClick"],fe={class:"content"},me={class:"name"},ke={class:"create-time"},ye={key:1,class:"no-data"},he={class:"text"},_e={class:"bottom-operate"},Ce={class:"content"},we={__name:"Index",setup($e){const{t:R}=z(),a=H(),D=O(),M=oe(),x=P(),g=b(0),y=b(10),l=q({pageNumber:0,tokenList:[],loading:!1,finished:!1,error:!1,refreshing:!1}),h=b(!1);function U(){M.$reset(),x.push("/createToken/create/Detail")}async function A(){a.walletAddress||G(R("pleaseConnectWallet"));try{let e=await(await F.wallet.contractTokenFactory(D.tokenFactoryAddress)).totalOwnRecordsForUser(a.walletAddress);g.value=Number(e)}catch(o){console.error(o)}finally{l.refreshing=!1}}async function w(){l.loading=!0;let o=J({duration:0}),e=(l.pageNumber*y.value).toString(),_=(l.pageNumber*y.value+y.value-1).toString();try{let v=await(await F.wallet.contractTokenFactory(D.tokenFactoryAddress)).getOwnRecords(a.walletAddress,e,_);console.log(v);for(let d of v){let $={tokenAddress:d[6].toLowerCase(),createTime:Number(d[0]),symbol:d[4],name:d[3],deployerId:Number(d[5])};l.tokenList.push($)}v.length<y.value||g.value==Number(_)+1?l.finished=!0:l.pageNumber++}catch(C){l.error=!0,console.log(C)}finally{o.close(),l.loading=!1,l.refreshing=!1}}async function V(){l.pageNumber=0,l.tokenList=[],l.finished=!1,await A(),g.value>0&&(console.log(g.value),w())}function j(o,e){x.push("/createToken/manage/"+o+"/"+e)}return E(()=>{let o=setInterval(async()=>{a.isConnectWallet&&(clearInterval(o),await A(),g.value>0&&w())},100)}),(o,e)=>{const _=f("van-list"),C=f("van-image"),v=f("van-pull-refresh"),d=f("van-button"),$=f("van-dialog");return c(),p(N,null,[n("div",ne,[n("div",ae,[n("div",le,[n("div",{onClick:e[0]||(e[0]=s=>t(a).showSelectDapp=!0)},[i(u,{class:"icon",name:"menu"})]),t(a).isConnectWallet?(c(),p("div",re,[i(se,{class:"switch-chain",onClick:e[1]||(e[1]=s=>t(a).showSelectChainPopup=!0),error:!t(a).chainId,logo:t(a).chainIcon,value:t(a).chain.toUpperCase()},null,8,["error","logo","value"]),n("div",ie,r(t(S)(t(a).walletAddress)),1),i(u,{class:"copy-icon",name:"copy",onClick:e[2]||(e[2]=L(s=>t(W)(t(a).walletAddress),["stop"]))})])):(c(),p("div",{key:1,class:"address",onClick:e[3]||(e[3]=(...s)=>t(a).connectWallet&&t(a).connectWallet(...s))},[i(u,{class:"icon",name:"wallet"}),n("div",ce,r(o.$t("pleaseConnectWallet")),1)]))]),n("div",de,[i(u,{class:"icon",name:"language",onClick:e[4]||(e[4]=s=>t(a).showLanguagePicker=!0)}),i(u,{class:"icon",name:"help",onClick:e[5]||(e[5]=s=>h.value=!0)})])]),n("div",ue,[n("div",pe,[n("div",ge,r(o.$t("myToken")),1),i(v,{modelValue:l.refreshing,"onUpdate:modelValue":e[9]||(e[9]=s=>l.refreshing=s),"pulling-text":o.$t("pulling"),"loosing-text":o.$t("loosing"),"loading-text":o.$t("loading"),onRefresh:V},{default:m(()=>[l.tokenList.length>0?(c(),I(_,{key:0,class:"token-list","loading-text":o.$t("loading"),loading:l.loading,"onUpdate:loading":e[6]||(e[6]=s=>l.loading=s),finished:l.finished,"finished-text":o.$t("noMore"),error:l.error,"onUpdate:error":e[7]||(e[7]=s=>l.error=s),"error-text":o.$t("errorText"),onLoad:e[8]||(e[8]=s=>w())},{default:m(()=>[(c(!0),p(N,null,K(l.tokenList,s=>(c(),p("div",{class:"item",onClick:B=>j(s.deployerId,s.tokenAddress)},[n("div",null,[i(Q,{class:"token-icon",tokenIcon:t(X)(t(a).chain.toLowerCase(),s.tokenAddress.toLowerCase()),chainIcon:t(Z)(t(a).chain.toLowerCase())},null,8,["tokenIcon","chainIcon"]),n("div",fe,[n("div",me,[n("span",null,r(s.symbol),1),n("span",null,"（"+r(s.name)+"）",1)]),n("div",null,[T(r(t(S)(s.tokenAddress))+" ",1),i(u,{class:"copy-icon",name:"copy",onClick:L(B=>t(W)(s.tokenAddress),["stop"])},null,8,["onClick"])]),n("div",ke,r(t(ee).unix(s.createTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),n("div",null,[i(u,{class:"image",name:"arrow"})])],8,ve))),256))]),_:1},8,["loading-text","loading","finished","finished-text","error","error-text"])):(c(),p("div",ye,[i(C,{class:"image",src:"/assets/images/warn.png"}),n("div",he,r(o.$t("noToken")),1)]))]),_:1},8,["modelValue","pulling-text","loosing-text","loading-text"])])]),n("div",_e,[t(a).isConnectWallet?(c(),I(d,{key:0,type:"primary",round:"",block:"",class:"btn",onClick:U},{default:m(()=>[T(r(o.$t("createToken")),1)]),_:1})):(c(),I(d,{key:1,type:"primary",round:"",block:"",class:"btn",onClick:t(a).connectWallet},{default:m(()=>[T(r(o.$t("connectWallet")),1)]),_:1},8,["onClick"]))])]),i($,{class:"help-dialog",show:h.value,title:o.$t("rulesDescription"),"confirm-button-text":o.$t("understand"),onConfirm:e[10]||(e[10]=s=>h.value=!1),onClose:e[11]||(e[11]=s=>h.value=!1),"close-on-click-overlay":""},{default:m(()=>[n("div",Ce,[n("div",{class:k(t(a).language)},r(o.$t("rulesDescription1",{chains:t(te)[t(a).dappType].chainList.map(s=>s.chain.toUpperCase()).join("/")})),3),n("div",{class:k(t(a).language)},r(o.$t("rulesDescription2")),3),n("div",{class:k(t(a).language)},r(o.$t("rulesDescription3")),3),n("div",{class:k(t(a).language)},r(o.$t("rulesDescription4")),3),n("div",{class:k(t(a).language)},r(o.$t("rulesDescription5")),3)])]),_:1},8,["show","title","confirm-button-text"])],64)}}},De=Y(we,[["__scopeId","data-v-7cb35e7e"]]);export{De as default};
