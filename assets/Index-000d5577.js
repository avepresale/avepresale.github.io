import{_ as U,b as j,j as H,n as T,C as q,h as x,r as C,o as v,q as S,f as t,d as $,y as N,w as A,c as l,B as c,t as o,l as r,F as G,D as k,P as B,E as D,G as M}from"./index-767ece26.js";import{_ as y,f as I,c as L}from"./TokenIcon-274813b6.js";import{f as b,B as P}from"./dayjs.min-7d665755.js";import{L as W,F as z}from"./Footer-7e57ba31.js";import{_ as J}from"./Dialog-634fc9e5.js";import{s as m}from"./function-call-fc91e39b.js";import"./Progress-1a4637b6.js";const K={class:"lanuch-pad-manage"},Q={class:"content"},X={class:"operate"},Y={class:"status"},Z={key:0,class:"auditing"},ee={key:1,class:"fail"},ae={class:"notes"},se={class:"support"},te={class:"dialog-content"},ne={__name:"Index",setup(oe){const F=j("global"),{t:i}=H(),f=T(!1),u=q();x();async function V(){if(!n.value)return;if(await(await k.wallet.contract(n.value.contractAddress,B)).isFunderChanged()){m(i("onlyOneChange"));return}f.value=!0}function O(){f.value=!1}async function R(){if(/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(g.value)){const s=D({message:i("changingAddress")+"...",forbidClick:!0,duration:0});try{const a=await k.wallet.contract(n.value.contractAddress,B);if(await a.funder()==g.value){m(i("receivingAddressLimit"));return}(await(await a.changeFunder(g.value)).wait()).status===1&&(m({type:"success",message:i("changeAddressSuccess")}),f.value=!1)}catch(a){console.log(a),a.info&&a.info.error&&a.info.error.code===4001?m(i("userCancelOperate")):a.error&&a.error.message&&a.error.message=="Canceled"?m(i("userCancelOperate")):m(i("unkonwError"))}finally{s.close()}}else m(i("inputCorrectAddress"))}const n=T(null),g=T("");async function E(){const s=D({message:i("getDetail")+"...",forbidClick:!0,duration:0});try{let a=await k.presale.getPresale(u.params.chain,u.params.contractAddress);if(a.status!=1)throw a.msg;let e=a.data,p=b(e.hardCap,Number(e.baseTokenDecimal)),h=b(e.softCap,Number(e.baseTokenDecimal)),w=P(e.salePrice).div("1000000").toString(),d=b(e.saleAmount,Number(e.baseTokenDecimal)),_=b(await k.wallet.getCumulateAmount(e.contractAddress),Number(e.tokenDecimal));n.value={isMine:!0,approveStatus:e.approveStatus,chain:u.params.chain,status:e.status,contractAddress:e.contractAddress,tokenAddress:e.tokenAddress,tokenName:e.tokenName,tokenSymbol:e.tokenSymbol,hardCap:p,softCap:h,baseTokenAddress:e.baseTokenAddress,baseTokenName:e.baseTokenName,baseTokenSymbol:e.baseTokenSymbol,baseTokenDecimal:e.baseTokenDecimal,startTime:e.startTime,endTime:e.endTime,endSaleTime:e.endSaleTime,endSaleTxHash:e.endSaleTxHash,salePrice:w,saleAmount:d,cumulateAmount:_,progressRate:P(_).div(p).multipliedBy(100).toNumber()}}catch(a){console.log(a)}finally{s.close()}}return E(),(s,a)=>{const e=C("van-button"),p=C("van-icon"),h=C("van-field"),w=C("van-cell-group");return v(),S(G,null,[t("div",K,[t("div",Q,[n.value?(v(),$(W,{key:0,presaleItem:n.value},null,8,["presaleItem"])):N("",!0),t("div",X,[n.value&&n.value.approveStatus!=1?(v(),$(e,{key:0,class:"btn unactive",type:"primary"},{default:A(()=>[c(o(s.$t("changeReceivingAddress")),1)]),_:1})):(v(),$(e,{key:1,class:"btn",type:"primary",onClick:V},{default:A(()=>[c(o(s.$t("changeReceivingAddress")),1)]),_:1}))]),t("div",Y,[n.value&&n.value.approveStatus==0?(v(),S("div",Z,[l(p,{name:"clock"}),c(o(s.$t("reviewWait"))+"~",1)])):N("",!0),n.value&&n.value.approveStatus==2?(v(),S("div",ee,[l(p,{name:"warning"}),c(o(s.$t("auditFailed"))+"~",1)])):N("",!0)]),t("div",ae,[t("div",null,o(s.$t("importantNote")),1),t("div",null,o(s.$t("noteInfo")),1),t("div",null,[c(o(r(I)(r(F).cfg.allowChainList.find(d=>d.chain==r(u).params.chain).presaleFactoryAddress.toLowerCase(),8))+" ",1),l(y,{name:"copy",onClick:a[0]||(a[0]=d=>r(L)(r(F).cfg.allowChainList.find(_=>_.chain==r(u).params.chain).presaleFactoryAddress.toLowerCase()))})]),t("div",null,[c(o(r(I)(r(u).params.contractAddress,8))+" ",1),l(y,{name:"copy",onClick:a[1]||(a[1]=d=>r(L)(r(u).params.contractAddress))})])]),t("div",se,[t("div",null,[c(o(s.$t("technicalSupport"))+": ",1),l(y,{class:"icon",name:"telegramBlue"})]),t("div",null,[c(o(s.$t("uploadFile"))+": ",1),l(y,{class:"icon",name:"telegramBlue"})])])]),l(z)]),l(J,{show:f.value,"onUpdate:show":a[3]||(a[3]=d=>f.value=d),title:s.$t("changeReceivingAddress"),onConfirmClick:R,onCancelClick:O},{default:A(()=>[M(s.$slots,"default",{},()=>[t("div",te,[t("text",null,"*"+o(s.$t("onlyOneChange")),1),l(w,{class:"cell",inset:""},{default:A(()=>[l(h,{class:"input",modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=d=>g.value=d),clearable:"",placeholder:s.$t("receiveAddressPrompt")},null,8,["modelValue","placeholder"])]),_:1})])],!0)]),_:3},8,["show","title"])],64)}}},pe=U(ne,[["__scopeId","data-v-df8223dd"]]);export{pe as default};
