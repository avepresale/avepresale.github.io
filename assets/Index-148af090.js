import{_ as H,b as R,j as q,n as T,C as G,h as M,r as C,o as m,q as S,f as s,d as N,y as I,w as k,c as o,B as r,t as F,l as n,F as z,D as y,P as D,E as L,G as J,p as K,g as Q}from"./index-50c344a8.js";import{_ as b,f as P,c as V}from"./TokenIcon-1709db4b.js";import{f as A,B as $}from"./dayjs.min-28e1ab39.js";import{L as W,F as X}from"./Footer-6c2a3f66.js";import{_ as Y}from"./Dialog-07c94ba7.js";import{s as i}from"./function-call-6146fb36.js";import"./Progress-096e06ac.js";const x=_=>(K("data-v-732925e5"),_=_(),Q(),_),Z={class:"lanuch-pad-manage"},ee={class:"content"},ae={class:"operate"},se={class:"status"},te={key:0,class:"auditing"},oe={key:1,class:"fail"},ne={class:"notes"},le=x(()=>s("div",null,"重要说明",-1)),re=x(()=>s("div",null,"如代币支持白名单(交易转账0损耗)配置，请将下方的平台合约地址，加入白名单中，以避免代币分发过程中的损耗。",-1)),ce={class:"support"},ie={class:"dialog-content"},de=x(()=>s("text",null,"*仅支持1次变更，请知悉",-1)),ue={__name:"Index",setup(_){const B=R("global"),{t:w}=q(),p=T(!1),c=G();M();async function O(){if(!t.value)return;if(await(await y.wallet.contract(t.value.contractAddress,D)).isFunderChanged()){i("仅支持变更一次收款地址！");return}p.value=!0}function E(){p.value=!1}async function U(){if(/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(v.value)){const d=L({message:"正在变更收款地址...",forbidClick:!0,duration:0});try{const a=await y.wallet.contract(t.value.contractAddress,D);if(await a.funder()==v.value){i("变更地址与原收款地址相同");return}(await(await a.changeFunder(v.value)).wait()).status===1&&(i({type:"success",message:"收款地址变更成功"}),p.value=!1)}catch(a){console.log(a),a.info&&a.info.error&&a.info.error.code===4001?i(w("userCancelOperate")):a.error&&a.error.message&&a.error.message=="Canceled"?i(w("userCancelOperate")):i(w("unkonwError"))}finally{d.close()}}else i("请输入正确的地址")}const t=T(null),v=T("");async function j(){const d=L({message:"请在获取详情...",forbidClick:!0,duration:0});try{let a=await y.presale.getPresale(c.params.chain,c.params.contractAddress);if(a.status!=1)throw a.msg;let e=a.data,u=A(e.hardCap,Number(e.baseTokenDecimal)),f=A(e.softCap,Number(e.baseTokenDecimal)),g=$(e.salePrice).div("1000000").toString(),l=A(e.saleAmount,Number(e.baseTokenDecimal)),h=A(await y.wallet.getCumulateAmount(e.contractAddress),Number(e.tokenDecimal));t.value={isMine:!0,approveStatus:e.approveStatus,chain:c.params.chain,status:e.status,contractAddress:e.contractAddress,tokenAddress:e.tokenAddress,tokenName:e.tokenName,tokenSymbol:e.tokenSymbol,hardCap:u,softCap:f,baseTokenAddress:e.baseTokenAddress,baseTokenName:e.baseTokenName,baseTokenSymbol:e.baseTokenSymbol,baseTokenDecimal:e.baseTokenDecimal,startTime:e.startTime,endTime:e.endTime,endSaleTime:e.endSaleTime,endSaleTxHash:e.endSaleTxHash,salePrice:g,saleAmount:l,cumulateAmount:h,progressRate:$(h).div(g).div(u).multipliedBy(100).toNumber()}}catch(a){console.log(a)}finally{d.close()}}return j(),(d,a)=>{const e=C("van-button"),u=C("van-icon"),f=C("van-field"),g=C("van-cell-group");return m(),S(z,null,[s("div",Z,[s("div",ee,[t.value?(m(),N(W,{key:0,presaleItem:t.value},null,8,["presaleItem"])):I("",!0),s("div",ae,[t.value&&t.value.approveStatus!=1?(m(),N(e,{key:0,class:"btn unactive",type:"primary"},{default:k(()=>[r("变更收款地址")]),_:1})):(m(),N(e,{key:1,class:"btn",type:"primary",onClick:O},{default:k(()=>[r("变更收款地址")]),_:1}))]),s("div",se,[t.value&&t.value.approveStatus==0?(m(),S("div",te,[o(u,{name:"clock"}),r("平台审核中，请耐心等待~")])):I("",!0),t.value&&t.value.approveStatus==2?(m(),S("div",oe,[o(u,{name:"warning"}),r("审核失败，如有问题请联系技术支持~")])):I("",!0)]),s("div",ne,[le,re,s("div",null,[r(F(n(P)(n(B).cfg.allowChainList.find(l=>l.chain==n(c).params.chain).presaleFactoryAddress.toLowerCase(),8))+" ",1),o(b,{name:"copy",onClick:a[0]||(a[0]=l=>n(V)(n(B).cfg.allowChainList.find(h=>h.chain==n(c).params.chain).presaleFactoryAddress.toLowerCase()))})]),s("div",null,[r(F(n(P)(n(c).params.contractAddress,8))+" ",1),o(b,{name:"copy",onClick:a[1]||(a[1]=l=>n(V)(n(c).params.contractAddress))})])]),s("div",ce,[s("div",null,[r(" 技术支持： "),o(b,{class:"icon",name:"telegramBlue"})]),s("div",null,[r(" 项目头像和资料上传： "),o(b,{class:"icon",name:"telegramBlue"})])])]),o(X)]),o(Y,{show:p.value,"onUpdate:show":a[3]||(a[3]=l=>p.value=l),title:"收款地址变更",onConfirmClick:U,onCancelClick:E},{default:k(()=>[J(d.$slots,"default",{},()=>[s("div",ie,[de,o(g,{class:"cell",inset:""},{default:k(()=>[o(f,{class:"input",modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=l=>v.value=l),clearable:"",placeholder:"请输入收款地址"},null,8,["modelValue"])]),_:1})])],!0)]),_:3},8,["show"])],64)}}},Ce=H(ue,[["__scopeId","data-v-732925e5"]]);export{Ce as default};
