import{_ as q,u as H,d as j,$ as z,g as S,h as G,i as Z,r as V,o as d,c as _,a as u,j as i,T as E,A as p,t,m as g,I as y,b as e,k as N,l as f,F as J,n as k,a0 as K,B as I,y as U,q as D,z as O,v as Y,Z as Q,L as W,M as X}from"./index-d72ad0f8.js";import{E as oo,U as eo}from"./UnlockPopup-80a1e8c4.js";import{e as to}from"./ethers-23e34e44.js";import{f as B}from"./units-ad51ddce.js";import"./SelectDate-b734c1ec.js";import"./OperateSuccessDialog-ce8ab644.js";import"./bignumber-3e8dfdf6.js";const so=h=>(W("data-v-3f297b1b"),h=h(),X(),h),ao={key:0,class:"body"},no={key:0,class:"token"},io={key:1,class:"token"},lo={class:"info"},co={class:"item"},ro={class:"key"},ko={class:"value"},mo={key:0,class:"item"},uo={class:"key"},po={class:"value"},yo={class:"item"},_o={class:"key"},ho={class:"value"},vo={class:"item"},wo={class:"key"},bo={key:0,class:"value"},fo={key:1,class:"value"},Lo={class:"item"},Co={class:"key"},So={class:"value"},go={class:"blue-font"},Io={class:"item"},Do={class:"key"},To={class:"value"},$o={class:"item"},Vo={class:"key"},Eo={class:"value"},Uo=so(()=>e("div",{class:"footer"},null,-1)),Ao={__name:"Detail",props:{lockId:String,tokenType:String,version:String},setup(h){const a=h,{t:M}=H(),L=j(),A=z(),C=S(!1),o=G({id:a.lockId,address:"",amountString:"",tokenList:[],lockDate:0,unlockDate:0,isLpToken:!1,symbol:"",chain:"",isExpired:!1,chainCoinSymbol:"",decimals:0}),T=S(!1),$=S(!1);async function x(){C.value=!1;let l;a.version=="V2"?l=await k.wallet.contractTokenLockV2(A.tokenLockV2Address):a.version=="V3"&&(l=await k.wallet.contractTokenLockV3(A.tokenLockV3Address)),console.dir(l);let s;try{console.log(a.lockId),s=await l.getLockById(a.lockId)}catch{K(M("failedToGetDetail"));return}if(o.lockDate=Number(s[4]),o.unlockDate=Number(s[5]),o.tokenId=s.tokenId,o.address=s[1],o.owner=s[2],o.isExpired=I().unix()>=o.unlockDate,o.chain=L.chain,o.chainCoinSymbol=L.chainCoinSymbol,a.tokenType=="lpToken"){if(a.version=="V2")try{const n=await k.wallet.contractLP(o.address);let c=await n.decimals();o.decimals=c;let r=await n.token0(),v=await(await k.wallet.contractERC20(r)).symbol(),w=await n.token1(),b=await(await k.wallet.contractERC20(w)).symbol();o.isLpToken=!0,o.tokenList[0]={symbol:v.toUpperCase(),address:r.toLowerCase()},o.tokenList[1]={symbol:b.toUpperCase(),address:w.toLowerCase()},o.amountString=B(s[3],c),o.symbol=`${v}/${b}`}catch(n){console.log(n)}else if(a.version=="V3")try{let c=await(await k.wallet.contractNFT(o.address)).positions(o.tokenId);console.log(c.token0);let r=c.token0,v=await(await k.wallet.contractERC20(r)).symbol(),w=c.token1,b=await(await k.wallet.contractERC20(w)).symbol();o.isLpToken=!0,o.tokenList[0]={symbol:v.toUpperCase(),address:r.toLowerCase()},o.tokenList[1]={symbol:b.toUpperCase(),address:w.toLowerCase()},o.liquidity=c.liquidity,o.symbol=`${v}/${b}`}catch(n){console.log(n)}}else if(a.tokenType=="token")try{const n=await k.wallet.contractERC20(o.address);let c=await n.symbol(),r=await n.decimals();o.decimals=r,o.tokenList=[],o.isLpToken=!1,o.symbol=c.toUpperCase(),o.amountString=B(s[3],r)}catch(n){console.log(n)}C.value=!0,console.log("getDetailDone")}function P(){console.log(o),T.value=!0}function F(){window.location.reload()}return Z(()=>{x()}),S(!0),console.log(a.lockId),console.log(a.tokenType),(l,s)=>{const n=V("van-icon"),c=V("van-button"),r=V("van-action-bar");return d(),_(J,null,[C.value?(d(),_("div",ao,[o.isLpToken?(d(),_("div",no,[u(E,{class:"token-icon",tokenIcon:i(U)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),u(E,{class:"token-icon",tokenIcon:i(U)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"]),p(" "+t(`${o.symbol} (${i(D)(o.address)})`),1)])):(d(),_("div",io,[o.address?(d(),g(E,{key:0,class:"token-icon",tokenIcon:i(U)(o.chain,o.address.toLowerCase()),chainIcon:i(O)(o.chain)},null,8,["tokenIcon","chainIcon"])):y("",!0),p(" "+t(`${o.symbol} (${i(D)(o.address)})`),1)])),e("ul",lo,[e("li",co,[e("div",ro,t(l.$t("contractAddress")),1),e("div",ko,[p(t(i(D)(o.address))+" ",1),u(N,{class:"copy-icon",name:"copy",onClick:s[0]||(s[0]=m=>i(Y)(o.address))})])]),a.version=="V3"?(d(),_("li",mo,[e("div",uo,t(l.$t("tokenID")),1),e("div",po,t(a.lockId),1)])):y("",!0),e("li",yo,[e("div",_o,t(l.$t("contractChian")),1),e("div",ho,t(o.chain.toUpperCase()),1)]),e("li",vo,[e("div",wo,t(`${o.symbol} ${l.$t("lockNumber")}`),1),a.version=="V2"?(d(),_("div",bo,t(o.amountString),1)):y("",!0),a.version=="V3"?(d(),_("div",fo,t(i(to).formatEther(o.liquidity.toString())),1)):y("",!0)]),e("li",Lo,[e("div",Co,t(l.$t("unlockTime2")),1),e("div",So,[e("span",null,t(i(I).unix(o.unlockDate).format("YYYY-MM-DD HH:mm:ss")),1),e("span",null,[p("("),e("span",go,t(o.isExpired?l.$t("expired"):l.$t("dayLeft",{day:i(Q)(i(I).unix(o.unlockDate).toDate())})),1),p(")")])])]),e("li",Io,[e("div",Do,t(l.$t("lockUser")),1),e("div",To,[p(t(i(D)(o.owner))+" ",1),u(N,{class:"copy-icon",name:"copy",onClick:s[1]||(s[1]=m=>i(Y)(o.owner))})])]),e("li",$o,[e("div",Vo,t(l.$t("lockTime")),1),e("div",Eo,t(i(I).unix(o.lockDate).format("YYYY-MM-DD HH:mm:ss")),1)])])])):y("",!0),Uo,C.value&&i(L).walletAddress&&o.owner.toLowerCase()==i(L).walletAddress.toLowerCase()?(d(),g(r,{key:1,class:"tools"},{default:f(()=>[o.isExpired?y("",!0):(d(),g(c,{key:0,class:"btn",color:"#9F3FF7",onClick:P},{icon:f(()=>[u(n,{name:"edit"})]),default:f(()=>[p(t(l.$t("edit")),1)]),_:1})),o.isExpired?(d(),g(c,{key:1,class:"btn",color:"#3F80F7",onClick:s[2]||(s[2]=m=>$.value=!0)},{icon:f(()=>[u(n,{name:"after-sale"})]),default:f(()=>[p(t(l.$t("withdraw")),1)]),_:1})):y("",!0),u(oo,{show:T.value,"onUpdate:show":s[3]||(s[3]=m=>T.value=m),onSuccess:F,isLockV2:a.version=="V2",lockId:o.id,isLpToken:o.isLpToken,chain:o.chain,unlockDate:o.unlockDate,tokenList:o.tokenList,symbol:o.symbol,address:o.address,chainCoinSymbol:o.chainCoinSymbol,amountString:o.amountString,decimals:o.decimals},null,8,["show","isLockV2","lockId","isLpToken","chain","unlockDate","tokenList","symbol","address","chainCoinSymbol","amountString","decimals"]),u(eo,{show:$.value,"onUpdate:show":s[4]||(s[4]=m=>$.value=m),onSuccess:F,isLockV2:a.version=="V2",lockId:o.id,isLpToken:o.isLpToken,chain:o.chain,unlockDate:o.unlockDate,tokenList:o.tokenList,symbol:o.symbol,address:o.address,chainCoinSymbol:o.chainCoinSymbol,amountString:o.amountString,decimals:o.decimals},null,8,["show","isLockV2","lockId","isLpToken","chain","unlockDate","tokenList","symbol","address","chainCoinSymbol","amountString","decimals"])]),_:1})):y("",!0)],64)}}},Ro=q(Ao,[["__scopeId","data-v-3f297b1b"]]);export{Ro as default};
